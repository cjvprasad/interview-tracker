<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DSA Mastery | Professional Suite</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- FontAwesome -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
      rel="stylesheet"
    />
    <!-- Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <!-- PrismJS for Syntax Highlighting -->
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
      rel="stylesheet"
    />

    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ["Inter", "sans-serif"],
              mono: ["JetBrains Mono", "monospace"],
            },
            colors: {
              brand: {
                50: "#eff6ff",
                100: "#dbeafe",
                500: "#3b82f6",
                600: "#2563eb",
                900: "#1e3a8a",
              },
              dark: {
                bg: "#0f172a",
                sidebar: "#1e293b",
                card: "#334155",
                border: "#475569",
              },
            },
          },
        },
      };
    </script>
    <style>
      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
      }
      ::-webkit-scrollbar-track {
        background: transparent;
      }
      ::-webkit-scrollbar-thumb {
        background: #475569;
        border-radius: 3px;
      }
      ::-webkit-scrollbar-thumb:hover {
        background: #64748b;
      }

      /* Animations */
      .fade-in {
        animation: fadeIn 0.3s ease-in-out;
      }
      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(5px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      .active-card {
        border-left: 4px solid #3b82f6;
        background-color: rgba(59, 130, 246, 0.1);
      }
      .nav-btn {
        @apply px-4 py-2 rounded border border-slate-600 text-slate-300 hover:bg-slate-700 hover:text-white transition-colors text-sm flex items-center gap-2;
      }

      /* Badge Colors */
      .badge-Easy {
        @apply bg-green-900/30 text-green-400 border-green-800;
      }
      .badge-Medium {
        @apply bg-yellow-900/30 text-yellow-400 border-yellow-800;
      }
      .badge-Hard {
        @apply bg-red-900/30 text-red-400 border-red-800;
      }

      /* Checkbox Custom Style */
      .custom-checkbox:checked {
        background-color: #10b981;
        border-color: #10b981;
      }
      .custom-checkbox:checked + div {
        opacity: 1;
      }

      /* --- EDITOR STYLES --- */
      .editor-container {
        position: relative;
        width: 100%;
        height: 100%;
        font-family: "JetBrains Mono", monospace;
        font-size: 14px;
        line-height: 1.5;
      }
      .editor-layer {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        padding: 1rem;
        margin: 0;
        border: 0;
        box-sizing: border-box;
        background: transparent;
        white-space: pre;
        overflow: auto;
        word-wrap: normal;
      }
      textarea.editor-layer {
        z-index: 10;
        color: transparent;
        caret-color: white;
        resize: none;
        outline: none;
      }
      pre.editor-layer {
        z-index: 5;
        pointer-events: none;
        color: #ccc;
      }
      code[class*="language-"],
      pre[class*="language-"] {
        text-shadow: none !important;
        font-family: "JetBrains Mono", monospace !important;
        font-size: 14px !important;
        line-height: 1.5 !important;
        padding: 0 !important;
        margin: 0 !important;
        background: transparent !important;
      }
    </style>
  </head>
  <body
    class="h-screen w-screen overflow-hidden bg-[#0f172a] text-slate-200 font-sans flex flex-col md:flex-row"
  >
    <!-- TOAST -->
    <div
      id="toast"
      class="fixed top-5 right-5 bg-slate-800 border border-slate-600 text-white px-4 py-3 rounded shadow-xl transform translate-x-full transition-transform duration-300 z-50 flex items-center gap-3"
    >
      <i class="fa-solid fa-circle-info text-blue-400"></i>
      <span id="toast-msg">Notification</span>
    </div>

    <!-- SIDEBAR -->
    <aside
      id="sidebar-panel"
      class="w-full md:w-80 flex-shrink-0 flex flex-col border-r border-slate-700 bg-[#1e293b] h-full absolute md:relative z-20 transform transition-transform duration-300 md:translate-x-0"
    >
      <div
        class="h-16 flex items-center px-6 border-b border-slate-700 bg-[#1e293b] z-10 shrink-0 justify-between"
      >
        <div class="flex items-center gap-3">
          <div
            class="w-8 h-8 bg-brand-600 rounded-lg flex items-center justify-center text-white shadow-lg shadow-brand-500/30"
          >
            <i class="fa-solid fa-layer-group"></i>
          </div>
          <span class="font-bold text-lg tracking-tight text-white"
            >DSA Mastery</span
          >
        </div>
        <button
          onclick="toggleAllPhases()"
          class="text-slate-400 hover:text-white transition-colors"
          title="Collapse/Expand All"
        >
          <i id="toggle-all-icon" class="fa-solid fa-compress"></i>
        </button>
      </div>
      <div
        class="flex-1 overflow-y-auto p-3 space-y-6"
        id="sidebar-content"
      ></div>
      <div class="p-4 border-t border-slate-700 bg-[#1e293b] shrink-0">
        <div class="flex justify-between text-xs text-slate-400 mb-2">
          <span>Global Progress</span><span id="global-progress-text">0%</span>
        </div>
        <div class="w-full h-2 bg-slate-700 rounded-full overflow-hidden">
          <div
            id="global-progress-bar"
            class="h-full bg-brand-500 w-0 transition-all duration-500"
          ></div>
        </div>
        <button
          onclick="resetData()"
          class="mt-3 w-full py-2 text-xs text-red-400 hover:bg-slate-700/50 rounded transition-colors"
        >
          Reset All Data
        </button>
      </div>
    </aside>

    <!-- MAIN -->
    <main
      id="main-panel"
      class="flex-1 flex flex-col min-w-0 bg-[#0f172a] relative h-full w-full hidden md:flex"
    ></main>

    <!-- SCRIPTS -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>

    <script src="data.js"></script>
    <script>
      // --- STATE ---
      // We use this to remember which phases are open so they don't collapse on re-render
      const phaseState = { p1: true, p2: true, p3: true, p4: true, p5: true };
      let allExpanded = true;

      function getProblemDetails(problemName) {
        if (problemsDB[problemName]) {
          return { ...problemsDB[problemName], title: problemName };
        }
        return {
          title: problemName,
          difficulty: "Medium",
          desc: `<p>Solve <strong>${problemName}</strong>.</p>`,
          examples: [{ input: "n=5", output: "res" }],
          constraints: ["N<=10^5"],
          starterCode: `function solve() {\n    console.log("Generic Solver");\n    return true;\n}`,
          solution: `function solve() {\n    // Optimal solution logic\n    return true;\n}`,
          interviewQs: [{ q: "Complexity?", a: "O(N)" }],
        };
      }

      let activePatternId = 1;
      let currentFilter = "All";
      let activeTab = "desc";

      function init() {
        loadProgress();
        renderSidebar();
        renderDetail(activePatternId);
        handleResize();
        window.addEventListener("resize", handleResize);
      }

      function handleResize() {
        if (window.innerWidth >= 768) {
          document
            .getElementById("sidebar-panel")
            .classList.remove("hidden", "absolute");
          document.getElementById("main-panel").classList.remove("hidden");
        }
      }
      function showMobileSidebar() {
        document.getElementById("sidebar-panel").classList.remove("hidden");
        document.getElementById("main-panel").classList.add("hidden");
      }
      function showMobileDetail() {
        if (window.innerWidth < 768) {
          document.getElementById("sidebar-panel").classList.add("hidden");
          document.getElementById("main-panel").classList.remove("hidden");
        }
      }

      function toggleAllPhases() {
        allExpanded = !allExpanded;
        document.getElementById("toggle-all-icon").className = allExpanded
          ? "fa-solid fa-compress"
          : "fa-solid fa-expand";
        phases.forEach((p) => {
          const c = document.getElementById(`content-${p.id}`);
          const i = document.getElementById(`icon-${p.id}`);
          if (allExpanded) {
            c.classList.remove("hidden");
            i.classList.remove("-rotate-90");
            phaseState[p.id] = true;
          } else {
            c.classList.add("hidden");
            i.classList.add("-rotate-90");
            phaseState[p.id] = false;
          }
        });
      }

      function togglePhase(id) {
        phaseState[id] = !phaseState[id];
        renderSidebar();
      }

      function getPhaseProgress(phaseId) {
        const phasePatterns = patterns.filter((p) => p.phase === phaseId);
        if (phasePatterns.length === 0) return 0;
        let total = 0,
          solved = 0;
        phasePatterns.forEach((pat) => {
          total += pat.problems.length;
          pat.problems.forEach((_, i) => {
            if (localStorage.getItem(`chk-${pat.id}-${i}`) === "true") solved++;
          });
        });
        return total === 0 ? 0 : Math.round((solved / total) * 100);
      }

      function renderSidebar() {
        const container = document.getElementById("sidebar-content");
        let html = "";
        phases.forEach((phase) => {
          const phasePatterns = patterns.filter((p) => p.phase === phase.id);
          if (phasePatterns.length === 0) return;
          const phaseProgress = getPhaseProgress(phase.id);
          const progressColor =
            phaseProgress === 100
              ? "text-emerald-400"
              : phaseProgress > 0
              ? "text-blue-400"
              : "text-slate-500";
          const isOpen = phaseState[phase.id];

          html += `<div class="mb-4"><button onclick="togglePhase('${
            phase.id
          }')" class="w-full flex items-center justify-between px-2 py-2 mb-1 text-xs font-bold text-slate-500 uppercase hover:bg-slate-800 rounded transition-colors group"><div class="flex items-center gap-2"><span>${
            phase.title
          }</span><span class="text-[10px] ${progressColor} bg-slate-800 px-1.5 py-0.5 rounded border border-slate-700">${phaseProgress}%</span></div><i id="icon-${
            phase.id
          }" class="fa-solid fa-chevron-down transition-transform duration-200 ${
            isOpen ? "" : "-rotate-90"
          }"></i></button><div id="content-${
            phase.id
          }" class="space-y-1 transition-all duration-300 origin-top ${
            isOpen ? "" : "hidden"
          }">`;
          phasePatterns.forEach((pat) => {
            const isActive = pat.id === activePatternId;
            const progress = getPatternProgress(pat);
            let statusColor = "bg-slate-700";
            if (progress > 0) statusColor = "bg-blue-500";
            if (progress === 100) statusColor = "bg-emerald-500";
            html += `<div onclick="selectPattern(${
              pat.id
            })" class="group cursor-pointer rounded-lg p-2.5 transition-all border border-transparent hover:bg-slate-700/50 ${
              isActive ? "active-card bg-slate-700/30" : ""
            }"><div class="flex justify-between items-center mb-1"><span class="text-xs font-medium truncate ${
              isActive
                ? "text-blue-400"
                : "text-slate-300 group-hover:text-white"
            }">${
              pat.name
            }</span><span class="text-[10px] text-slate-500 ml-2">${Math.round(
              progress
            )}%</span></div><div class="w-full h-1 bg-slate-800 rounded-full overflow-hidden"><div class="h-full ${statusColor} transition-all duration-500" style="width: ${progress}%"></div></div></div>`;
          });
          html += `</div></div>`;
        });
        container.innerHTML = html;
        updateGlobalProgress();
      }

      function renderDetail(id) {
        const pat = patterns.find((p) => p.id === id);
        if (!pat) return;
        const phase = phases.find((ph) => ph.id === pat.phase);
        const mainArea = document.getElementById("main-panel");
        mainArea.innerHTML = `
                <header class="h-16 border-b border-slate-700 flex items-center justify-between px-4 md:px-8 bg-[#0f172a]/90 backdrop-blur z-10 shrink-0">
                    <div class="flex items-center gap-4 overflow-hidden"><button onclick="showMobileSidebar()" class="md:hidden text-slate-400 hover:text-white"><i class="fa-solid fa-arrow-left"></i></button><div><div class="flex items-center gap-2 text-xs text-slate-500 mb-1"><span class="hidden md:inline">${
                      phase.title
                    }</span><i class="fa-solid fa-chevron-right text-[8px] hidden md:inline"></i><span>Pattern ${
          pat.id
        }</span></div><h1 class="text-lg md:text-xl font-bold text-white truncate">${
          pat.name
        }</h1></div></div>
                    <a href="https://leetcode.com/problemset/all/" target="_blank" class="px-4 py-2 bg-slate-800 hover:bg-slate-700 text-slate-300 text-xs font-semibold rounded border border-slate-600 transition-colors">LeetCode <i class="fa-solid fa-external-link-alt ml-2"></i></a>
                </header>
                <div class="flex-1 overflow-y-auto p-4 md:p-8 scroll-smooth" id="detail-content">
                    <div class="max-w-4xl mx-auto fade-in pb-20">
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                            <div class="bg-[#1e293b] border border-slate-700 rounded-xl p-6 shadow-sm"><div class="flex items-center gap-2 mb-4 text-blue-400"><i class="fa-regular fa-lightbulb"></i><h2 class="text-sm font-bold uppercase tracking-wide">The Strategy</h2></div><p class="text-slate-300 text-sm leading-relaxed mb-4">${
                              pat.desc
                            }</p><div class="bg-slate-800/50 rounded-lg p-3 border-l-2 border-blue-500"><p class="text-xs text-slate-400 italic">"${
          pat.strategy
        }"</p></div></div>
                            <div class="bg-[#0f172a] border border-slate-700 rounded-xl overflow-hidden shadow-sm flex flex-col"><div class="bg-[#1e293b] px-4 py-2 border-b border-slate-700 flex justify-between items-center"><span class="text-xs font-mono text-slate-400">Anchor Code</span><span class="text-[10px] bg-slate-700 text-slate-300 px-2 py-0.5 rounded">Pseudo-code</span></div><div class="p-4 overflow-x-auto custom-scroll"><pre><code class="language-javascript">${
                              pat.anchor.logic
                            }</code></pre></div></div>
                        </div>
                        <div class="bg-[#1e293b] border border-slate-700 rounded-xl overflow-hidden mb-8"><div class="px-6 py-4 border-b border-slate-700 flex flex-col md:flex-row md:justify-between md:items-center gap-4"><div class="flex items-center gap-4"><h2 class="font-bold text-white flex items-center gap-2"><i class="fa-solid fa-list-check text-slate-400"></i> Practice Problems</h2><span class="text-xs text-slate-500">${
                          pat.problems.length
                        } Challenges</span></div><div><select id="filter-select" onchange="filterProblems(${id})" class="bg-slate-800 text-slate-300 text-xs border border-slate-600 rounded px-2 py-1 outline-none focus:border-blue-500 w-full md:w-auto"><option value="All">All Levels</option><option value="Easy">Easy</option><option value="Medium">Medium</option><option value="Hard">Hard</option></select></div></div><div class="divide-y divide-slate-700/50" id="problem-list-container">${renderProblemList(
          pat
        )}</div></div>
                    </div>
                </div>
                <div class="h-16 border-t border-slate-700 bg-[#1e293b] flex items-center justify-between px-4 md:px-8 shrink-0" id="detail-footer"></div>`;

        Prism.highlightAllUnder(document.getElementById("detail-content"));
        renderFooterNav(id);
      }

      function renderFooterNav(id) {
        const footer = document.getElementById("detail-footer");
        const prevPat = patterns.find((p) => p.id === id - 1);
        const nextPat = patterns.find((p) => p.id === id + 1);
        footer.innerHTML = `<div>${
          prevPat
            ? `<button onclick="selectPattern(${prevPat.id})" class="nav-btn"><i class="fa-solid fa-arrow-left"></i> <span class="hidden md:inline">${prevPat.name}</span><span class="md:hidden">Prev</span></button>`
            : ""
        }</div><div>${
          nextPat
            ? `<button onclick="selectPattern(${nextPat.id})" class="nav-btn"><span class="hidden md:inline">${nextPat.name}</span><span class="md:hidden">Next</span> <i class="fa-solid fa-arrow-right"></i></button>`
            : ""
        }</div>`;
      }

      function renderProblemList(pat) {
        const difficulties = ["Easy", "Medium", "Hard"];
        const filtered = pat.problems
          .map((p, i) => ({
            name: p,
            difficulty: difficulties[i % 3],
            index: i,
          }))
          .filter(
            (p) => currentFilter === "All" || p.difficulty === currentFilter
          );
        if (filtered.length === 0)
          return `<div class="p-6 text-center text-slate-500 text-sm">No problems found for this filter.</div>`;

        return filtered
          .map((probObj) => {
            const uid = `chk-${pat.id}-${probObj.index}`;
            const isChecked = localStorage.getItem(uid) === "true";
            const rowClass = isChecked
              ? "bg-emerald-900/10 border-l-2 border-emerald-500"
              : "hover:bg-slate-700/30 border-l-2 border-transparent";
            const textClass = isChecked
              ? "text-emerald-400 opacity-80"
              : "text-slate-200 group-hover:text-blue-400";

            return `<div class="group flex items-center px-4 md:px-6 py-4 transition-all cursor-pointer ${rowClass}" onclick="openProblem('${
              probObj.name
            }', ${pat.id}, ${
              probObj.index
            })"><div onclick="event.stopPropagation()" class="shrink-0 checkbox-wrapper"><label class="relative flex items-center cursor-pointer"><input type="checkbox" id="${uid}" onchange="toggleCheck('${uid}', ${
              pat.id
            })" class="peer sr-only custom-checkbox" ${
              isChecked ? "checked" : ""
            }><div class="w-5 h-5 border-2 border-slate-500 rounded peer-checked:bg-emerald-500 peer-checked:border-emerald-500 transition-all flex items-center justify-center"><i class="fa-solid fa-check text-white text-[12px] opacity-0 peer-checked:opacity-100"></i></div></label></div><div class="ml-4 flex-1 min-w-0"><span class="text-sm font-medium transition-colors truncate block ${textClass}">${
              probObj.name
            }</span></div><div class="flex items-center gap-3 shrink-0"><span class="text-[10px] border px-2 py-0.5 rounded-full badge-${
              probObj.difficulty
            }">${
              probObj.difficulty
            }</span><div class="opacity-0 group-hover:opacity-100 transition-opacity hidden md:block"><button class="text-xs bg-slate-700 hover:bg-slate-600 text-slate-300 px-3 py-1.5 rounded font-medium flex items-center gap-2"><i class="fa-solid fa-code"></i> Solve</button></div></div></div>`;
          })
          .join("");
      }

      function filterProblems(patId) {
        currentFilter = document.getElementById("filter-select").value;
        const pat = patterns.find((p) => p.id === patId);
        document.getElementById("problem-list-container").innerHTML =
          renderProblemList(pat);
      }

      function openProblem(problemName, patId, probIndex) {
        const data = getProblemDetails(problemName);
        window.currentProblemData = data;
        const mainArea = document.getElementById("main-panel");
        const uid = `chk-${patId}-${probIndex}`;
        const isChecked = localStorage.getItem(uid) === "true";

        mainArea.innerHTML = `<header class="h-14 border-b border-slate-700 flex items-center justify-between px-4 md:px-6 bg-[#1e293b] z-10 shrink-0"><div class="flex items-center gap-4 overflow-hidden"><button onclick="renderDetail(${patId})" class="text-slate-400 hover:text-white transition-colors text-sm flex items-center gap-2 shrink-0"><i class="fa-solid fa-arrow-left"></i> <span class="hidden md:inline">Back</span></button><div class="h-4 w-px bg-slate-600 shrink-0"></div><h1 class="font-bold text-slate-200 text-sm truncate">${
          data.title
        }</h1></div><div class="flex gap-2 items-center shrink-0"><div class="hidden md:flex items-center gap-2 text-xs text-slate-400 bg-slate-800 px-3 py-1.5 rounded border border-slate-600"><i class="fa-brands fa-js text-yellow-400"></i> JS Only</div><button id="solver-check-btn" onclick="toggleSolverCheck('${uid}', ${patId})" class="px-3 py-1.5 text-xs border border-slate-600 rounded transition-colors flex items-center gap-2 ${
          isChecked
            ? "bg-emerald-900/30 text-emerald-400 border-emerald-800"
            : "text-slate-300 hover:bg-slate-700"
        }"><i class="fa-solid fa-check ${
          isChecked ? "" : "opacity-50"
        }"></i> <span class="hidden md:inline">${
          isChecked ? "Completed" : "Mark Done"
        }</span></button><button onclick="runCode()" class="px-3 py-1.5 text-xs bg-green-600 hover:bg-green-500 text-white rounded transition-colors flex items-center gap-2 font-bold shadow-lg shadow-green-500/20"><i class="fa-solid fa-play"></i> <span class="hidden md:inline">Run</span></button></div></header><div class="flex-1 flex flex-col md:flex-row overflow-hidden"><div class="w-full md:w-1/2 flex flex-col border-r border-slate-700 bg-[#0f172a] h-1/2 md:h-full"><div class="flex border-b border-slate-700 bg-[#1e293b]"><button onclick="switchTab('desc')" id="tab-desc" class="flex-1 px-4 py-2 text-sm font-medium border-b-2 border-blue-400 text-blue-400 bg-[#0f172a]">Description</button><button onclick="switchTab('interview')" id="tab-interview" class="flex-1 px-4 py-2 text-sm font-medium border-b-2 border-transparent text-slate-400 hover:text-slate-200">Interview</button><button onclick="switchTab('solution')" id="tab-solution" class="flex-1 px-4 py-2 text-sm font-medium border-b-2 border-transparent text-slate-400 hover:text-slate-200">Solution</button></div><div class="flex-1 overflow-y-auto p-6 custom-scroll" id="tab-content"></div></div><div class="w-full md:w-1/2 flex flex-col bg-[#1e1e1e] h-1/2 md:h-full border-t md:border-t-0 border-slate-700"><div class="h-8 bg-[#1e1e1e] border-b border-[#333] flex items-center px-2 shrink-0"><div class="px-3 h-full flex items-center bg-[#1e1e1e] text-xs text-slate-300 border-t-2 border-blue-500 font-medium"><i class="fa-brands fa-js text-orange-500 mr-2"></i> Solution.js</div></div><div class="editor-container"><div class="editor-layer" style="z-index:0"><pre><code id="highlighting-content" class="language-javascript"></code></pre></div><textarea id="code-editor" class="editor-layer" spellcheck="false" oninput="updateHighlight(this.value)" onscroll="syncScroll(this)">${
          data.starterCode
        }</textarea></div><div class="h-40 border-t border-slate-700 bg-[#0f172a] p-3 font-mono text-xs overflow-y-auto shrink-0" id="console-output"><div class="text-slate-500">Console Output...</div></div></div></div>`;

        updateHighlight(data.starterCode);
        switchTab("desc");
        showMobileDetail();
      }

      function updateHighlight(text) {
        let result_element = document.querySelector("#highlighting-content");
        if (!result_element) return;
        if (text[text.length - 1] == "\n") text += " ";
        result_element.innerHTML = text
          .replace(new RegExp("&", "g"), "&amp;")
          .replace(new RegExp("<", "g"), "&lt;");
        Prism.highlightElement(result_element);
      }
      function syncScroll(element) {
        let result_element = document.querySelector("#highlighting-content");
        if (result_element) {
          result_element.parentElement.parentElement.scrollTop =
            element.scrollTop;
          result_element.parentElement.parentElement.scrollLeft =
            element.scrollLeft;
        }
      }

      function switchTab(tabName) {
        activeTab = tabName;
        const data = window.currentProblemData;
        const container = document.getElementById("tab-content");
        ["desc", "interview", "solution"].forEach((t) => {
          document.getElementById(`tab-${t}`).className =
            t === tabName
              ? "flex-1 px-4 py-2 text-sm font-medium border-b-2 border-blue-400 text-blue-400 bg-[#0f172a]"
              : "flex-1 px-4 py-2 text-sm font-medium border-b-2 border-transparent text-slate-400 hover:text-slate-200";
        });
        if (tabName === "desc")
          container.innerHTML = `<div class="text-slate-300 text-sm leading-relaxed">${
            data.desc
          }<div class="mt-6 space-y-4">${data.examples
            .map(
              (ex, i) =>
                `<div><p class="font-bold text-slate-200 mb-2">Example ${
                  i + 1
                }:</p><div class="bg-slate-800/50 p-3 rounded border-l-2 border-slate-600 font-mono text-xs"><p><span class="text-slate-400">Input:</span> ${
                  ex.input
                }</p><p><span class="text-slate-400">Output:</span> ${
                  ex.output
                }</p></div></div>`
            )
            .join(
              ""
            )}</div><div class="mt-8"><p class="font-bold text-slate-200 mb-2">Constraints:</p><ul class="list-disc pl-5 space-y-1 text-slate-400 text-xs">${data.constraints
            .map((c) => `<li>${c}</li>`)
            .join("")}</ul></div></div>`;
        else if (tabName === "interview")
          container.innerHTML = `<div class="space-y-4">${data.interviewQs
            .map(
              (iq, i) =>
                `<div class="border border-slate-700 rounded bg-slate-800/30 overflow-hidden"><button onclick="document.getElementById('ans-${i}').classList.toggle('hidden')" class="w-full text-left px-4 py-3 text-xs font-medium text-slate-300 hover:bg-slate-800 transition-colors flex justify-between items-center">${iq.q}<i class="fa-solid fa-chevron-down text-slate-500"></i></button><div id="ans-${i}" class="hidden px-4 py-3 bg-slate-900/50 border-t border-slate-700 text-xs text-slate-400">${iq.a}</div></div>`
            )
            .join("")}</div>`;
        else if (tabName === "solution") {
          container.innerHTML = `<div class="bg-[#1e1e1e] p-4 rounded border border-slate-700 overflow-x-auto"><pre><code class="language-javascript">${data.solution}</code></pre></div>`;
          Prism.highlightAllUnder(container);
        }
      }

      function runCode() {
        const consoleDiv = document.getElementById("console-output");
        const code = document.getElementById("code-editor").value;
        consoleDiv.innerHTML = `<div class="text-yellow-500"><i class="fa-solid fa-circle-notch fa-spin"></i> Running...</div>`;
        setTimeout(() => {
          try {
            let logs = [];
            const mockConsole = {
              log: (...args) => logs.push(args.join(" ")),
              error: (...args) => logs.push(args.join(" ")),
            };
            new Function("console", code)(mockConsole);
            let outputHtml = `<div class="text-emerald-400 font-bold mb-2">Execution Complete</div>`;
            if (logs.length)
              outputHtml +=
                `<div class="text-slate-300 mb-1 border-b border-slate-700 pb-1">Console Output:</div>` +
                logs
                  .map(
                    (l) => `<div class="font-mono text-slate-400">> ${l}</div>`
                  )
                  .join("");
            else
              outputHtml += `<div class="text-slate-500 italic">No output log found.</div>`;
            consoleDiv.innerHTML = outputHtml;
          } catch (e) {
            consoleDiv.innerHTML = `<div class="text-red-500 font-bold mb-2">Runtime Error</div><div class="text-red-300">${e.message}</div>`;
          }
        }, 500);
      }

      function selectPattern(id) {
        activePatternId = id;
        renderSidebar();
        renderDetail(id);
        showMobileDetail();
      }
      function toggleCheck(uid, patId) {
        localStorage.setItem(uid, document.getElementById(uid).checked);
        renderSidebar();
        const row = document.getElementById(uid).closest(".group");
        if (document.getElementById(uid).checked) {
          row.classList.add(
            "bg-emerald-900/10",
            "border-l-2",
            "border-emerald-500"
          );
          row
            .querySelector("span")
            .classList.add("text-emerald-400", "opacity-80");
        } else {
          row.classList.remove(
            "bg-emerald-900/10",
            "border-l-2",
            "border-emerald-500"
          );
          row
            .querySelector("span")
            .classList.remove("text-emerald-400", "opacity-80");
        }
      }
      function toggleSolverCheck(uid, patId) {
        const wasChecked = localStorage.getItem(uid) === "true";
        localStorage.setItem(uid, !wasChecked);
        renderSidebar();
        const btn = document.getElementById("solver-check-btn");
        if (!wasChecked) {
          btn.className =
            "px-3 py-1.5 text-xs border border-emerald-800 bg-emerald-900/30 text-emerald-400 rounded transition-colors flex items-center gap-2";
          btn.innerHTML =
            '<i class="fa-solid fa-check"></i> <span class="hidden md:inline">Completed</span>';
        } else {
          btn.className =
            "px-3 py-1.5 text-xs border border-slate-600 text-slate-300 hover:bg-slate-700 rounded transition-colors flex items-center gap-2";
          btn.innerHTML =
            '<i class="fa-solid fa-check opacity-50"></i> <span class="hidden md:inline">Mark Done</span>';
        }
      }
      function getPatternProgress(pat) {
        let c = 0;
        pat.problems.forEach((_, i) => {
          if (localStorage.getItem(`chk-${pat.id}-${i}`) === "true") c++;
        });
        return pat.problems.length
          ? Math.round((c / pat.problems.length) * 100)
          : 0;
      }
      function updateGlobalProgress() {
        let t = 0,
          s = 0;
        patterns.forEach((p) => {
          t += p.problems.length;
          p.problems.forEach((_, i) => {
            if (localStorage.getItem(`chk-${p.id}-${i}`) === "true") s++;
          });
        });
        document.getElementById("global-progress-text").innerText = `${
          t ? Math.round((s / t) * 100) : 0
        }% Complete`;
        document.getElementById("global-progress-bar").style.width = `${
          t ? Math.round((s / t) * 100) : 0
        }%`;
      }
      function loadProgress() {}
      function resetData() {
        if (confirm("Clear all?")) {
          localStorage.clear();
          init();
        }
      }

      init();
    </script>
  </body>
</html>
