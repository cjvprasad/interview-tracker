<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Frontend Interview Prep Explorer</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM CDNs -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
      /* Custom styles for responsiveness and clean aesthetic */
      body {
        font-family: "Inter", sans-serif;
        background-color: #f9fafb;
      }
      .scroll-content::-webkit-scrollbar {
        display: none;
      }
      .scroll-content {
        -ms-overflow-style: none; /* IE and Edge */
        scrollbar-width: none; /* Firefox */
      }
      /* Custom hover class for QuestionCard simulation */
      .card-hover:hover {
        box-shadow: 0 8px 24px rgba(59, 130, 246, 0.15);
        border: 2px solid #3b82f6;
        transform: translateY(-2px);
        transition: box-shadow 0.2s, border 0.2s, transform 0.2s;
      }
    </style>
  </head>
  <body>
    <div id="root"></div>

    <script src="interviewQuestions.js"></script>
    <script type="text/babel">
      const { useState, useMemo } = React;
      const root = ReactDOM.createRoot(document.getElementById("root"));

      // --- 2. Code Block Component (Replaces SyntaxHighLighter) ---
      const CodeBlock = ({
        codeString = "",
        output = null,
        isExplanation = false,
      }) => {
        const [isDark, setIsDark] = useState(true);
        const bgColor = isDark ? "bg-gray-800" : "bg-white border-gray-300";
        const textColor = isDark ? "text-white" : "text-gray-900";
        const headerBg = isDark ? "bg-gray-700" : "bg-gray-200";
        const buttonStyle = isDark
          ? "border-gray-600 text-white hover:bg-gray-600"
          : "border-gray-400 text-gray-800 hover:bg-gray-300";

        const handleCopy = () => {
          // Using document.execCommand('copy') for robust clipboard access in various environments
          const el = document.createElement("textarea");
          el.value = codeString || output;
          document.body.appendChild(el);
          el.select();
          try {
            document.execCommand("copy");
          } catch (err) {
            console.error("Failed to copy text: ", err);
          }
          document.body.removeChild(el);
        };

        return (
          <div
            className={`${bgColor} ${textColor} rounded-lg overflow-hidden my-4 shadow-lg border ${
              isDark ? "border-gray-700" : "border-gray-300"
            }`}
          >
            <div
              className={`${headerBg} flex justify-between items-center p-2 text-sm`}
            >
              <span className="font-mono opacity-80">
                {isExplanation ? "TEXT" : "JAVASCRIPT"}
              </span>
              <div className="flex space-x-2">
                <button
                  onClick={handleCopy}
                  className={`px-2 py-1 text-xs rounded border ${buttonStyle} transition`}
                >
                  üìã Copy
                </button>
                <button
                  onClick={() => setIsDark(!isDark)}
                  className={`px-2 py-1 text-xs rounded border ${buttonStyle} transition`}
                >
                  {isDark ? "üåû Light" : "üåô Dark"}
                </button>
              </div>
            </div>

            {codeString && (
              <pre className="p-4 overflow-x-auto text-sm leading-relaxed">
                <code style={{ whiteSpace: "pre-wrap" }}>
                  {codeString.trim()}
                </code>
              </pre>
            )}

            {output && (
              <div
                className={`p-3 border-t ${
                  isDark
                    ? "border-gray-700 bg-gray-900 text-green-400"
                    : "border-gray-300 bg-gray-50 text-gray-700"
                } text-sm`}
              >
                <strong className="font-semibold">Console Output:</strong>
                <pre className="m-0 text-xs font-mono">{output}</pre>
              </div>
            )}
          </div>
        );
      };

      // --- 3. Question Detail View Component ---
      const QuestionDetail = ({ question, onBack }) => (
        <div className="p-6 md:p-10 max-w-4xl mx-auto my-6 bg-white rounded-xl shadow-2xl">
          <button
            onClick={onBack}
            className="flex items-center space-x-2 px-4 py-2 mb-6 bg-gray-600 text-white rounded-lg shadow hover:bg-gray-700 transition"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              className="h-4 w-4"
              viewBox="0 0 20 20"
              fill="currentColor"
            >
              <path
                fillRule="evenodd"
                d="M9.707 14.707a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 1.414L7.414 9H15a1 1 0 110 2H7.414l2.293 2.293a1 1 0 010 1.414z"
                clipRule="evenodd"
              />
            </svg>
            <span>Back to List</span>
          </button>

          <h1 className="text-3xl md:text-4xl font-extrabold text-blue-800 pb-3 mb-4 border-b-2 border-blue-100">
            Q{question.id}: {question.title}
          </h1>
          <p className="text-lg text-gray-600 mb-6">
            <span className="font-bold text-gray-700">Category:</span>{" "}
            {question.category}
          </p>

          <h2 className="text-2xl font-semibold mt-6 mb-2 text-gray-800 flex items-center">
            <span className="text-blue-500 mr-2">üìù</span> Explanation
          </h2>
          <CodeBlock codeString={question.explanation} isExplanation={true} />

          <h2 className="text-2xl font-semibold mt-6 mb-2 text-gray-800 flex items-center">
            <span className="text-yellow-500 mr-2">üí°</span> Interview Tips /
            Pitfalls
          </h2>
          <CodeBlock codeString={question.tips} isExplanation={true} />

          <h2 className="text-2xl font-semibold mt-6 mb-2 text-gray-800 flex items-center">
            <span className="text-green-500 mr-2">üíª</span> Code Snippet
          </h2>
          <CodeBlock codeString={question.codeString} language="javascript" />

          <h2 className="text-2xl font-semibold mt-6 mb-2 text-gray-800 flex items-center">
            <span className="text-red-500 mr-2">‚úÖ</span> Expected Output
          </h2>
          <CodeBlock output={question.output} />

          <button
            onClick={onBack}
            className="flex items-center space-x-2 px-4 py-2 mt-8 bg-gray-600 text-white rounded-lg shadow hover:bg-gray-700 transition"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              className="h-4 w-4"
              viewBox="0 0 20 20"
              fill="currentColor"
            >
              <path
                fillRule="evenodd"
                d="M9.707 14.707a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 1.414L7.414 9H15a1 1 0 110 2H7.414l2.293 2.293a1 1 0 010 1.414z"
                clipRule="evenodd"
              />
            </svg>
            <span>Back to List</span>
          </button>
        </div>
      );

      // --- 4. Question Card Component ---
      const QuestionCard = ({ id, title, explanation, category, onClick }) => {
        return (
          <div
            className="card-hover p-5 rounded-xl border-2 border-gray-200 bg-white shadow-md flex flex-col justify-between transition duration-200 cursor-pointer"
            onClick={onClick}
          >
            <div>
              <h3 className="text-xl font-bold mb-1 text-gray-900">
                Q{id}: {title}
              </h3>
              <p className="text-sm font-semibold text-blue-600 mb-3">
                Category: {category}
              </p>
              <p className="text-sm text-gray-600 mb-4">
                {explanation.substring(0, 100)}...
              </p>
            </div>
            <button className="self-start px-4 py-2 text-sm bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition">
              View Full Detail
            </button>
          </div>
        );
      };

      // --- 5. Main Application Component ---
      const App = () => {
        const [search, setSearch] = useState("");
        const [selectedTitle, setSelectedTitle] = useState("All");
        const [selectedCategory, setSelectedCategory] = useState("All");
        const [sortBy, setSortBy] = useState("id");
        const [sortOrder, setSortOrder] = useState("asc");
        const [selectedQuestionDetail, setSelectedQuestionDetail] =
          useState(null);

        // Extract unique categories and titles
        const allCategories = useMemo(
          () => ["All", ...new Set(interviewQuestions.map((q) => q.category))],
          []
        );
        const allTitles = useMemo(
          () => ["All", ...new Set(interviewQuestions.map((q) => q.title))],
          []
        );

        // Core Filtering and Sorting Logic
        const filteredAndSortedQuestions = useMemo(() => {
          let questions = interviewQuestions;

          // Filtering
          if (search) {
            questions = questions.filter(
              (q) =>
                q.title.toLowerCase().includes(search.toLowerCase()) ||
                q.explanation.toLowerCase().includes(search.toLowerCase())
            );
          } else {
            if (selectedTitle !== "All") {
              questions = questions.filter((q) => q.title === selectedTitle);
            }
            if (selectedCategory !== "All") {
              questions = questions.filter(
                (q) => q.category === selectedCategory
              );
            }
          }

          // Sorting
          const sorted = [...questions].sort((a, b) => {
            let comparison = 0;
            if (sortBy === "id") {
              comparison = a.id - b.id;
            } else if (sortBy === "title") {
              const titleA = a.title.toLowerCase();
              const titleB = b.title.toLowerCase();
              if (titleA > titleB) comparison = 1;
              if (titleA < titleB) comparison = -1;
            }

            return sortOrder === "asc" ? comparison : -comparison;
          });

          return sorted;
        }, [search, selectedTitle, selectedCategory, sortBy, sortOrder]);

        // Event Handlers
        const handleClear = () => {
          setSearch("");
          setSelectedTitle("All");
          setSelectedCategory("All");
          setSortBy("id");
          setSortOrder("asc");
          setSelectedQuestionDetail(null);
        };

        const handleSearchChange = (e) => {
          setSearch(e.target.value);
          setSelectedTitle("All"); // Reset title filter on search
          setSelectedQuestionDetail(null);
        };

        const handleSelectCategoryChange = (e) => {
          setSelectedCategory(e.target.value);
          setSearch(""); // Reset search on filter change
          setSelectedQuestionDetail(null);
        };

        const handleSelectTitleChange = (e) => {
          setSelectedTitle(e.target.value);
          setSearch(""); // Reset search on filter change
          setSelectedQuestionDetail(null);
        };

        // Conditional Render for Detail View
        if (selectedQuestionDetail) {
          return (
            <div className="p-4 md:p-8">
              <QuestionDetail
                question={selectedQuestionDetail}
                onBack={() => setSelectedQuestionDetail(null)}
              />
            </div>
          );
        }

        return (
          <div className="p-6 md:p-10 max-w-6xl mx-auto">
            <h1 className="text-4xl font-extrabold text-blue-800 mb-2">
              üß† Frontend Interview Prep Explorer
            </h1>
            <p className="text-gray-600 mb-6 text-lg">
              Navigate, filter, and sort **{interviewQuestions.length}**
              essential JavaScript and React topics.
            </p>

            {/* Search Input */}
            <input
              placeholder="üîç Search question titles, keywords, or explanations..."
              value={search}
              onChange={handleSearchChange}
              className="w-full p-3 mb-6 rounded-lg border-2 border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-500 transition shadow-sm text-lg"
            />

            {/* Filter & Sort Controls */}
            <div className="flex flex-wrap gap-4 mb-6 items-end">
              {/* Category Filter */}
              <div className="flex flex-col flex-1 min-w-[200px]">
                <label className="text-sm font-semibold text-gray-700 mb-1">
                  Category:
                </label>
                <select
                  value={selectedCategory}
                  onChange={handleSelectCategoryChange}
                  className="p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                >
                  {allCategories.map((category) => (
                    <option key={category} value={category}>
                      {category === "All" ? `‚Äî All Categories ‚Äî` : category}
                    </option>
                  ))}
                </select>
              </div>

              {/* Title Filter */}
              <div className="flex flex-col flex-1 min-w-[200px]">
                <label className="text-sm font-semibold text-gray-700 mb-1">
                  Specific Title:
                </label>
                <select
                  value={selectedTitle}
                  onChange={handleSelectTitleChange}
                  className="p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                  disabled={search.length > 0}
                >
                  {allTitles.map((title) => (
                    <option key={title} value={title}>
                      {title === "All" ? `‚Äî All Titles ‚Äî` : title}
                    </option>
                  ))}
                </select>
              </div>

              {/* Sort By */}
              <div className="flex flex-col w-full md:w-auto flex-shrink">
                <label className="text-sm font-semibold text-gray-700 mb-1">
                  Sort By:
                </label>
                <select
                  value={sortBy}
                  onChange={(e) => setSortBy(e.target.value)}
                  className="p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                >
                  <option value="id">ID</option>
                  <option value="title">Title</option>
                </select>
              </div>

              {/* Sort Order */}
              <div className="flex flex-col w-full md:w-auto flex-shrink">
                <label className="text-sm font-semibold text-gray-700 mb-1">
                  Order:
                </label>
                <select
                  value={sortOrder}
                  onChange={(e) => setSortOrder(e.target.value)}
                  className="p-2 border border-gray-300 rounded-md focus:ring-blue-500 focus:border-blue-500"
                >
                  <option value="asc">Ascending</option>
                  <option value="desc">Descending</option>
                </select>
              </div>

              {/* Clear Button */}
              <button
                onClick={handleClear}
                className="w-full md:w-auto px-4 py-2 bg-red-500 text-white rounded-lg font-bold shadow-md hover:bg-red-600 transition self-end"
              >
                üîÑ Reset All Filters
              </button>
            </div>

            <hr className="my-6 border-gray-300" />

            {/* Results Section */}
            <p className="text-xl font-medium text-gray-700 mb-4">
              Showing{" "}
              <span className="text-blue-600 font-bold">
                {filteredAndSortedQuestions.length}
              </span>{" "}
              result(s):
            </p>
            <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 pb-10">
              {filteredAndSortedQuestions.length > 0 ? (
                filteredAndSortedQuestions.map((q) => (
                  <QuestionCard
                    key={q.id}
                    {...q}
                    onClick={() => setSelectedQuestionDetail(q)}
                  />
                ))
              ) : (
                <div className="col-span-full p-8 text-center bg-white border-4 border-dashed border-gray-300 rounded-xl text-gray-600 font-medium">
                  No matching questions found. Try broadening your search or
                  resetting filters.
                </div>
              )}
            </div>
          </div>
        );
      };

      // Initial render
      root.render(<App />);
    </script>
  </body>
</html>
